@{
    ViewBag.Title = "PersonnelSettings";
}

<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxtabs.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxcheckbox.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxlistbox.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxtabs.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxgrid.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxgrid.sort.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxgrid.pager.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxgrid.selection.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxgrid.edit.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxdata.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxnumberinput.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxinput.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxdropdownlist.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxexpander.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxvalidator.js")"></script>
<script src="@Url.Content("~/Scripts/jquery_lib/implement-ui-widget-1.0.js")" type="text/javascript"></script>
<script type="text/javascript">

  function _initializeFormElements(theme, datasource){

       $('#jqxTabs').jqxTabs({ width: '100%', height: 400, position: 'top', theme: theme });
       $("#chkAutogenerateEmpNum").jqxCheckBox({ theme: theme, width: '185px', checked: false });
       $("#maxEmployabilityAge").jqxNumberInput({ width: '150px', height: '25px', spinButtons: true, theme: theme, min: 0, max: 80 });
       $("#minEmployabilityAge").jqxNumberInput({ width: '150px', height: '25px', spinButtons: true, theme: theme, min: 0, max: 80 });
       $("#maxBackDateDays").jqxNumberInput({ width: '150px', height: '25px', spinButtons: true, theme: theme, min: 0, max: 80 });
       $("#positionName").jqxInput({ theme: theme, width: '300px', height: '25px', placeHolder: "enter Job Position" });
       $("#gradeNum").jqxInput({ theme: theme, width: '300px', height: '25px', placeHolder: "enter Job Grade number" });
       $("#gradeName").jqxInput({ theme: theme, width: '300px', height: '25px', placeHolder: "enter description" });
       $("#deptname").jqxInput({ source: datasource, displayMember: "DeptName", valueMember: "DeptID", theme: theme, width: '340px', height: '25px' ,placeHolder:"enter department name" });
       $("#defineJobPositionBtn").jqxButton({ theme: theme});
       $("#saveJobPositionBtn").jqxButton({ theme: theme });
       $('#saveSettingsBtn').jqxButton({theme: theme});
       $('#defineJobGradeBtn').jqxButton({theme: theme});
       $('#saveJobGradeBtn').jqxButton({theme: theme});
       $('#viewJobGradeBtn').jqxButton({theme: theme});
       $('#viewJobPositionBtn').jqxButton({theme: theme});


      ///<SUMMARY>
      /// Input validation code
      ///</SUMMARY>
      $('#personnelSettings-form').jqxValidator({
      	    rules: [
      	            { input: '#gradeNum', message: 'Grade Id is required!', action: 'keyup, blur', rule: 'required' },
      	            { input: '#gradeNum', message: 'Grade Id must be between 3 and 15 characters long', action: 'keyup, blur', rule: function(input){

                                            if((input.val().trim().length < 3) || (input.val().trim().length > 15)){
                                                     return false;
                                            } else {
                                            	return true;
                                            }
      	            } 
      	           },
      	           { input: '#gradeName', message: 'Grade name must contain only letters!', action: 'keyup', rule: 'notNumber' },
      	           { input: '#positionName', message: 'Position name is required!', action: 'keyup, blur', rule: 'required' },
      	           { input: '#positionName', message: 'Position name must be between 5 and 30 characters long', action: 'keyup, blur', rule: function(input){

                                            if((input.val().trim().length < 5) || (input.val().trim().length > 30)){
                                                     return false;
                                            } else {
                                            	return true;
                                            }
      	            } 
      	           }

      	       ],theme: theme
      });



  }

  $(document).ready(function(){
   
        _glcontroller = "Settings";
        var theme = getDemoTheme();
        var title = 'Personnel settings';
        var deptId = "";
        var autoGenerateEmpNums = 0;

       ///<SUMMARY>
       ///populate the data source for the department
       ///</SUMMARY>

       var _deptDataSource = {
           datatype: 'json',
           datafields: [{ name: 'DeptID', type: 'string' },
                         { name: 'DeptName', type: 'string'}],
           id: 'DeptID',
           url: '/Department/GetDepartments'
       };

      var deptDataAdapter = new $.jqx.dataAdapter(_deptDataSource);

      document.getElementById("job-position").style.visibility = "hidden";

      document.getElementById("job-grade").style.visibility = "hidden";

      _initializeFormElements(theme, deptDataAdapter);


      $('#chkAutogenerateEmpNum').on('change',function(event){

      	if($('#chkAutogenerateEmpNum').val() === false){

           autoGenerateEmpNums = 0;

      	} else {

           autoGenerateEmpNums = 1;
      	}	
      	  
      	
      });

      $("#defineJobPositionBtn").click(function(){

      	 document.getElementById("job-position").style.visibility = "visible";

      });

      $("#defineJobGradeBtn").click(function(){

      	 document.getElementById("job-grade").style.visibility = "visible";

      });

      $('#deptname').on('select',function(event){

      	 if (event.args){
      	 	 deptId = event.args.value;
      	 }

      });

      $("#saveJobPositionBtn").click(function(){

      	  _glfunctionInvoked ="saveJobPositionBtn";

      	  var record = {Name: $('#positionName').val(), DeptId: deptId};

      	  _addNewRecord(record, _glcontroller);
          
          ///<SUMMARY>
          /// Clear the input controls for the next input
          ///</SUMMARY>

      	  $('#positionName').val("");
      	  $('#deptname').val("");

      });

      $('#saveJobGradeBtn').click(function(){

      	  _glfunctionInvoked = "saveJobGradeBtn";

      	  var record = {GradeId: $('#gradeNum').val(), Name: $('#gradeName').val()};

          if($('#personnelSettings-form').jqxValidator('validate')){
          	   
          	   _addNewRecord(record, _glcontroller);

          } else {

          	   console.log("Validation failed!");
          }

      	  

      	  $('#gradeName').val("");
      	  $('#gradeNum').val("");

      });

      $('#saveSettingsBtn').click(function(){

      	   _glfunctionInvoked = "saveSettingsBtn";


      	   var record = {AutogenerateEmpNums: autoGenerateEmpNums,
      	                 MaxEmploymentAge: $('#maxEmployabilityAge').val(),
      	                 MinEmploymentAge: $('#minEmployabilityAge').val(),
      	                 MaxBackDateDays: $('#maxBackDateDays').val()
      	             };
      	   
      	    _addNewRecord(record, _glcontroller);
      	
      });

  });

</script>

@Html.Partial("_personnelSettings")